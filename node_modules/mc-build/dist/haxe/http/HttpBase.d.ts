import {Bytes} from "../io/Bytes"

export type StringKeyValue = {
	name: string, 
	value: string
}

/**
This class can be used to handle Http requests consistently across
platforms. There are two intended usages:

- call `haxe.Http.requestUrl(url)` and receive the result as a `String`
(only available on `sys` targets)
- create a `new haxe.Http(url)`, register your callbacks for `onData`,
`onError` and `onStatus`, then call `request()`.
*/
export declare class HttpBase {
	constructor(url: string)
	
	/**
	The url of `this` request. It is used only by the `request()` method and
	can be changed in order to send the same request to different target
	Urls.
	*/
	url: string
	readonly responseData: null | string
	responseBytes: null | Bytes
	protected responseAsString: null | string
	protected postData: null | string
	protected postBytes: null | Bytes
	protected headers: StringKeyValue[]
	protected params: StringKeyValue[]
	protected emptyOnData: (arg0: string) => void
	
	/**
	This method is called upon a successful request, with `data` containing
	the result String.
	
	The intended usage is to bind it to a custom function:
	`httpInstance.onData = function(data) { // handle result }`
	*/
	onData(data: string): void
	
	/**
	This method is called upon a successful request, with `data` containing
	the result String.
	
	The intended usage is to bind it to a custom function:
	`httpInstance.onBytes = function(data) { // handle result }`
	*/
	onBytes(data: Bytes): void
	
	/**
	This method is called upon a request error, with `msg` containing the
	error description.
	
	The intended usage is to bind it to a custom function:
	`httpInstance.onError = function(msg) { // handle error }`
	*/
	onError(msg: string): void
	
	/**
	This method is called upon a Http status change, with `status` being the
	new status.
	
	The intended usage is to bind it to a custom function:
	`httpInstance.onStatus = function(status) { // handle status }`
	*/
	onStatus(status: number): void
	
	/**
	Override this if extending `haxe.Http` with overriding `onData`
	*/
	protected hasOnData(): boolean
	protected success(data: Bytes): void
	protected get_responseData(): null | string
}
