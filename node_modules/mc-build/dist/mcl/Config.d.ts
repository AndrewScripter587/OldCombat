import {FeatureFlags} from "./FeatureFlags"
import {Io} from "../Io"

export declare class EventDispatcher<T> {
	constructor()
	subscribe(callback: ((arg0: T) => void)): void
	dispatch(event: T): void
	protected _subscribers: ((arg0: T) => void)[]
}

export type PreBuildEvent = {
}

export type PostBuildEvent = {
	success: boolean
}

export declare class ConfigEvents {
	constructor()
	onPreBuild: EventDispatcher<PreBuildEvent>
	onPostBuild: EventDispatcher<PostBuildEvent>
}

export declare class ConfigUtil {
	static lock<T extends {
	}>(obj: T): T
}

export declare class Config {
	protected constructor()
	libDir: string
	events: ConfigEvents
	generatedDirName: string
	
	/**
	*
	* The name of the scoreboard that will be used to store the internal state of the mcb.
	*/
	internalScoreboardName: string
	
	/**
	*
	* The Io instance that will be used to handle file writing, this is not compatible with the `io-thread-count` argument
	*/
	io: null | Io
	eqVarScoreboardName: string
	eqConstScoreboardName: string
	dontEmitComments: boolean
	formatVersion: number
	features: FeatureFlags
	
	/**
	*
	* The message to put at the top of every file that is generated by mcb that supports comments.
	*
	*/
	header: string
	static create(base: UserConfig): Config
	protected static mergeFeatureFlagsToConfig(c: Config): void
}

export declare interface UserConfig {
	libDir: null | string
	generatedDirName: null | string
	
	/**
	*
	* The name of the scoreboard that will be used to store the internal state of the mcb.
	*/
	internalScoreboardName: null | string
	eqVarScoreboardName: null | string
	eqConstScoreboardName: null | string
	
	/**
	*
	* The message to put at the top of every file that is generated by mcb that supports comments.
	*
	*/
	header: null | string
	
	/**
	*
	* The number of threads to use for file writing, this is not compatible with the `io` parameter or `io-thread-count` argument
	*
	*/
	ioThreadCount: null | number
	
	/**
	* allows for binding of compiler events.
	*/
	setup: null | ((arg0: Config) => void)
	
	/**
	*
	*/
	dontEmitComments: null | boolean
	
	/**
	* assumed format version
	*/
	formatVersion: null | number
}
