import {Server} from "net"
import {Buffer} from "buffer"

export type TLSSocketOptions = {
	/**
	possible NPN protocols. (Protocols should be ordered by their priority).
	*/
	NPNProtocols?: null | string[] | Buffer, 
	/**
	A function that will be called if client supports SNI TLS extension.
	Two argument will be passed to it: `servername`, and `cb`.
	SNICallback should invoke `cb(null, ctx)`, where `ctx` is a SecureContext instance.
	(You can use tls.createSecureContext(...) to get proper `SecureContext`).
	If `SNICallback` wasn't provided - default callback with high-level API will be used.
	*/
	SNICallback?: null | ((servername: string, cb: ((arg0: Error) => SecureContext)) => void), 
	/**
	If true - TLS socket will be instantiated in server-mode
	*/
	isServer?: null | boolean, 
	/**
	If true the server will reject any connection which is not authorized with the list of supplied CAs.
	This option only has an effect if `requestCert` is true.
	Default: false.
	*/
	rejectUnauthorized?: null | boolean, 
	/**
	If true the server will request a certificate from clients that connect
	and attempt to verify that certificate.
	Default: false.
	*/
	requestCert?: null | boolean, 
	/**
	If true - OCSP status request extension would be added to client hello,
	and OCSPResponse event will be emitted on socket before establishing secure communication
	*/
	requestOCSP?: null | boolean, 
	/**
	An optional TLS context object from `Tls.createSecureContext`
	*/
	secureContext?: null | SecureContext, 
	server?: null | Server, 
	/**
	A Buffer instance, containing TLS session.
	*/
	session?: null | Buffer
}
